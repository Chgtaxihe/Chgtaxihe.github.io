<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据结构-树 | Chgtaxihe&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <meta name="description" content="记录杂七杂八的东西">
    <meta name="keywords" content="个人技术博客,算法,数据结构">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.1886a7c0.css" as="style"><link rel="preload" href="/assets/js/app.decb9dad.js" as="script"><link rel="preload" href="/assets/js/2.04fd8913.js" as="script"><link rel="preload" href="/assets/js/3.4c5a2de2.js" as="script"><link rel="prefetch" href="/assets/js/10.96ba1d64.js"><link rel="prefetch" href="/assets/js/100.a62e8b5b.js"><link rel="prefetch" href="/assets/js/101.2ac07909.js"><link rel="prefetch" href="/assets/js/102.62291ce1.js"><link rel="prefetch" href="/assets/js/103.eadafbac.js"><link rel="prefetch" href="/assets/js/104.be939afb.js"><link rel="prefetch" href="/assets/js/105.d1c8b34f.js"><link rel="prefetch" href="/assets/js/106.3505bd34.js"><link rel="prefetch" href="/assets/js/107.884346b1.js"><link rel="prefetch" href="/assets/js/108.01ed61e2.js"><link rel="prefetch" href="/assets/js/109.9dc57c56.js"><link rel="prefetch" href="/assets/js/11.ad0078d4.js"><link rel="prefetch" href="/assets/js/110.7458a50b.js"><link rel="prefetch" href="/assets/js/111.edc75dcc.js"><link rel="prefetch" href="/assets/js/112.5c70cc37.js"><link rel="prefetch" href="/assets/js/113.f91affd8.js"><link rel="prefetch" href="/assets/js/114.5eb3c5f8.js"><link rel="prefetch" href="/assets/js/115.31bd9969.js"><link rel="prefetch" href="/assets/js/116.1714a055.js"><link rel="prefetch" href="/assets/js/117.cb798048.js"><link rel="prefetch" href="/assets/js/118.d3b358e8.js"><link rel="prefetch" href="/assets/js/119.65c07ce7.js"><link rel="prefetch" href="/assets/js/12.be0c26a5.js"><link rel="prefetch" href="/assets/js/120.f584d903.js"><link rel="prefetch" href="/assets/js/121.85db4978.js"><link rel="prefetch" href="/assets/js/122.a951409e.js"><link rel="prefetch" href="/assets/js/123.545a8566.js"><link rel="prefetch" href="/assets/js/124.9f6f1435.js"><link rel="prefetch" href="/assets/js/125.ad29407c.js"><link rel="prefetch" href="/assets/js/126.961945db.js"><link rel="prefetch" href="/assets/js/127.6421efb4.js"><link rel="prefetch" href="/assets/js/128.86aedc19.js"><link rel="prefetch" href="/assets/js/129.4f37316c.js"><link rel="prefetch" href="/assets/js/13.de7404d9.js"><link rel="prefetch" href="/assets/js/130.695edae4.js"><link rel="prefetch" href="/assets/js/131.6b11994a.js"><link rel="prefetch" href="/assets/js/132.313151a3.js"><link rel="prefetch" href="/assets/js/133.564a04f4.js"><link rel="prefetch" href="/assets/js/134.0168024a.js"><link rel="prefetch" href="/assets/js/135.8472fc3e.js"><link rel="prefetch" href="/assets/js/136.0eec1fd3.js"><link rel="prefetch" href="/assets/js/137.b76552da.js"><link rel="prefetch" href="/assets/js/138.6c220f5b.js"><link rel="prefetch" href="/assets/js/139.83d25bd1.js"><link rel="prefetch" href="/assets/js/14.00c0dcd4.js"><link rel="prefetch" href="/assets/js/140.0ec915f9.js"><link rel="prefetch" href="/assets/js/141.7c187646.js"><link rel="prefetch" href="/assets/js/142.150122e3.js"><link rel="prefetch" href="/assets/js/15.6203e404.js"><link rel="prefetch" href="/assets/js/16.40e1841d.js"><link rel="prefetch" href="/assets/js/17.566b781d.js"><link rel="prefetch" href="/assets/js/18.6410d902.js"><link rel="prefetch" href="/assets/js/19.5b34cf1f.js"><link rel="prefetch" href="/assets/js/20.4136df04.js"><link rel="prefetch" href="/assets/js/21.47f3a612.js"><link rel="prefetch" href="/assets/js/22.6942c454.js"><link rel="prefetch" href="/assets/js/23.252a75b6.js"><link rel="prefetch" href="/assets/js/24.2db281f7.js"><link rel="prefetch" href="/assets/js/25.b8204e93.js"><link rel="prefetch" href="/assets/js/26.f36978a7.js"><link rel="prefetch" href="/assets/js/27.859fb4f0.js"><link rel="prefetch" href="/assets/js/28.7ae4f71e.js"><link rel="prefetch" href="/assets/js/29.1492c0f0.js"><link rel="prefetch" href="/assets/js/30.84cbed22.js"><link rel="prefetch" href="/assets/js/31.eb5b447d.js"><link rel="prefetch" href="/assets/js/32.1491336f.js"><link rel="prefetch" href="/assets/js/33.77fbf82e.js"><link rel="prefetch" href="/assets/js/34.71ac88cb.js"><link rel="prefetch" href="/assets/js/35.4fcf8ed0.js"><link rel="prefetch" href="/assets/js/36.83e239ef.js"><link rel="prefetch" href="/assets/js/37.5fec3ad9.js"><link rel="prefetch" href="/assets/js/38.cc4cb7ed.js"><link rel="prefetch" href="/assets/js/39.b91e5b70.js"><link rel="prefetch" href="/assets/js/4.14131d55.js"><link rel="prefetch" href="/assets/js/40.d9f80f0b.js"><link rel="prefetch" href="/assets/js/41.ecedf90f.js"><link rel="prefetch" href="/assets/js/42.5289e6c8.js"><link rel="prefetch" href="/assets/js/43.f7daed72.js"><link rel="prefetch" href="/assets/js/44.e93b44f4.js"><link rel="prefetch" href="/assets/js/45.67c3eef4.js"><link rel="prefetch" href="/assets/js/46.99f6f0c7.js"><link rel="prefetch" href="/assets/js/47.e4cf3976.js"><link rel="prefetch" href="/assets/js/48.8066fc5a.js"><link rel="prefetch" href="/assets/js/49.777427b0.js"><link rel="prefetch" href="/assets/js/5.4b0476be.js"><link rel="prefetch" href="/assets/js/50.9647ac5a.js"><link rel="prefetch" href="/assets/js/51.879b72bc.js"><link rel="prefetch" href="/assets/js/52.af276848.js"><link rel="prefetch" href="/assets/js/53.408c9970.js"><link rel="prefetch" href="/assets/js/54.915bbceb.js"><link rel="prefetch" href="/assets/js/55.44ee2b40.js"><link rel="prefetch" href="/assets/js/56.bef1516b.js"><link rel="prefetch" href="/assets/js/57.ac57044c.js"><link rel="prefetch" href="/assets/js/58.463dc4a1.js"><link rel="prefetch" href="/assets/js/59.2ced4a75.js"><link rel="prefetch" href="/assets/js/6.447af6c2.js"><link rel="prefetch" href="/assets/js/60.2f290481.js"><link rel="prefetch" href="/assets/js/61.c36a4b55.js"><link rel="prefetch" href="/assets/js/62.ea7514b4.js"><link rel="prefetch" href="/assets/js/63.85333ec0.js"><link rel="prefetch" href="/assets/js/64.b096949d.js"><link rel="prefetch" href="/assets/js/65.03b30d08.js"><link rel="prefetch" href="/assets/js/66.acbdcd48.js"><link rel="prefetch" href="/assets/js/67.970b5df7.js"><link rel="prefetch" href="/assets/js/68.eb35451e.js"><link rel="prefetch" href="/assets/js/69.98009205.js"><link rel="prefetch" href="/assets/js/7.41614d06.js"><link rel="prefetch" href="/assets/js/70.0b7c20e3.js"><link rel="prefetch" href="/assets/js/71.582a610d.js"><link rel="prefetch" href="/assets/js/72.38a2a4fa.js"><link rel="prefetch" href="/assets/js/73.853523f5.js"><link rel="prefetch" href="/assets/js/74.5349c8b8.js"><link rel="prefetch" href="/assets/js/75.69e5f6ce.js"><link rel="prefetch" href="/assets/js/76.e5e0777e.js"><link rel="prefetch" href="/assets/js/77.3c7ab538.js"><link rel="prefetch" href="/assets/js/78.cb91a37f.js"><link rel="prefetch" href="/assets/js/79.adb1be68.js"><link rel="prefetch" href="/assets/js/8.54257885.js"><link rel="prefetch" href="/assets/js/80.bf9f6489.js"><link rel="prefetch" href="/assets/js/81.2f9339ce.js"><link rel="prefetch" href="/assets/js/82.3184c4a1.js"><link rel="prefetch" href="/assets/js/83.d0b65d58.js"><link rel="prefetch" href="/assets/js/84.27951977.js"><link rel="prefetch" href="/assets/js/85.c74e8e01.js"><link rel="prefetch" href="/assets/js/86.1a29a217.js"><link rel="prefetch" href="/assets/js/87.a995b8a4.js"><link rel="prefetch" href="/assets/js/88.e949909c.js"><link rel="prefetch" href="/assets/js/89.d75d10cf.js"><link rel="prefetch" href="/assets/js/9.ea5249e7.js"><link rel="prefetch" href="/assets/js/90.568d1c5f.js"><link rel="prefetch" href="/assets/js/91.815ce8e7.js"><link rel="prefetch" href="/assets/js/92.d9b4cded.js"><link rel="prefetch" href="/assets/js/93.6f97e42f.js"><link rel="prefetch" href="/assets/js/94.15ef7aee.js"><link rel="prefetch" href="/assets/js/95.6a76685b.js"><link rel="prefetch" href="/assets/js/96.cf8dd1b7.js"><link rel="prefetch" href="/assets/js/97.a210a676.js"><link rel="prefetch" href="/assets/js/98.568a9c98.js"><link rel="prefetch" href="/assets/js/99.7410e59f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1886a7c0.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/avatar.png" alt="Chgtaxihe's blog" class="logo"> <span class="site-name can-hide">Chgtaxihe's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/training/" class="nav-link">练习</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法学习</a></div><div class="nav-item"><a href="/note/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/fun_staff/" class="nav-link">小玩意</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.jpg"> <div class="blogger-info"><h3>Chgtaxihe</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/training/" class="nav-link">练习</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法学习</a></div><div class="nav-item"><a href="/note/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/fun_staff/" class="nav-link">小玩意</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据结构-树</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/0e1041/#前置定义" class="sidebar-link">前置定义</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/0e1041/#avl树" class="sidebar-link">AVL树</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0e1041/#旋转时发生了什么" class="sidebar-link">旋转时发生了什么</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#插入-删除操作" class="sidebar-link">插入/删除操作</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#ll型" class="sidebar-link">LL型</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#java实现及测试代码" class="sidebar-link">Java实现及测试代码</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#优化" class="sidebar-link">优化</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/pages/0e1041/#b树-b-树" class="sidebar-link">B树（B-树）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0e1041/#插入与删除" class="sidebar-link">插入与删除</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#java实现" class="sidebar-link">Java实现</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#参考资料-2" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/pages/0e1041/#b-树" class="sidebar-link">B+树</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0e1041/#优点-2" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#实现" class="sidebar-link">实现</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#参考资料-3" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/pages/0e1041/#红黑树" class="sidebar-link">红黑树</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0e1041/#插入操作" class="sidebar-link">插入操作</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#删除操作-较难理解-附图" class="sidebar-link">删除操作（较难理解，附图）</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#java实现-2" class="sidebar-link">Java实现</a></li><li class="sidebar-sub-header"><a href="/pages/0e1041/#参考资料-4" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/pages/0e1041/#其他树-线段树-linkcuttree-splay等" class="sidebar-link">其他树（线段树/LinkCutTree/Splay等）</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/algorithm" title="算法学习-目录页" data-v-33863c7e>算法学习</a></li> <li data-v-33863c7e><a href="/algorithm/#数据结构" title="算法学习#数据结构" data-v-33863c7e>数据结构</a></li> <!----></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/chgtaxihe" target="_blank" title="作者" class="beLink" data-v-33863c7e>Chgtaxihe</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2021-02-23</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          数据结构-树
        </h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="前置定义"><a href="#前置定义" class="header-anchor">#</a> 前置定义</h2> <ul><li><p>满(full)二叉树：</p> <ul><li>英文wiki：每个节点都有0或2个子节点</li> <li>国内教材：除最低层的节点外，每个节点都有2个子节点（即第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>层的节点数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^i-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.907994em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>）</li></ul></li> <li><p>完美(perfect)二叉树：（国内版）满二叉树</p></li> <li><p>完全二叉树：除最底层外，每一层都被填满；最底层的节点尽可能靠左。</p> <blockquote><p>In a <strong>complete</strong> binary tree every level, <em>except possibly the last</em>, is completely filled, and all nodes in the last level are as far left as possible</p></blockquote></li></ul> <h2 id="avl树"><a href="#avl树" class="header-anchor">#</a> AVL树</h2> <p>定义：</p> <ul><li><p>AVL树：高度平衡的二叉搜索树（任意节点的两个子树的高度差<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">\le</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">≤</span></span></span></span> 1）</p></li> <li><p>平衡因子：某个节点的右子树高度-左子树高度</p> <p>因此，AVL树又可作如下定义：任意节点平衡因子的绝对值小于等于1的二叉搜索树</p></li></ul> <p>当插入或删除节点导致不平衡时，AVL通过旋转节点来重新平衡节点。</p> <h3 id="旋转时发生了什么"><a href="#旋转时发生了什么" class="header-anchor">#</a> 旋转时发生了什么</h3> <img src="/assets/img/AVL树_1.f21fa110.jpg" style="zoom:67%;"> <p>如图，设根节点的左子节点高度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">h_l</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，右子节点高度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">h_r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，下面以右旋为例</p> <img src="/assets/img/AVL树_2.c39e9a95.png" style="zoom:50%;"> <p>右旋以后，左子节点的高度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>h</mi><mi>l</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">h'_l</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span></span>，右子节点高度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>h</mi><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">h'_r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，观察可知</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>h</mi><mi>l</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><msub><mi>h</mi><mi>l</mi></msub><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>h</mi><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>r</mi></msub><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>h</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}h'_l&amp;\le h_l - 1\\ h'_r&amp;\le max(h_r+1,h_l)\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p> <p>显然右旋时，需要根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">h_e</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>来进行分类讨论。</p> <h3 id="插入-删除操作"><a href="#插入-删除操作" class="header-anchor">#</a> 插入/删除操作</h3> <p>同样以右旋为例</p> <img src="/assets/img/AVL树_3.9398e667.jpg" style="zoom:25%;"> <h3 id="ll型"><a href="#ll型" class="header-anchor">#</a> LL型</h3> <p>假设插入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>后使得当前子树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span>失衡，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>b</mi></msub><mo>=</mo><msub><mi>h</mi><mi>d</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h_b=h_d+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p> <p>由于插入前是AVL树，因此<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>e</mi></msub><mo>≤</mo><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">h_e\le h_c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> <p>对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>进行一次右旋，新的树有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>h</mi><mi>l</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>h</mi><mi>l</mi></msub><mo>−</mo><mn>1</mn><mo separator="true">,</mo><msubsup><mi>h</mi><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><msub><mi>h</mi><mi>c</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h'_l=h_l-1,h'_r=max(h_e,h_c)+1=h_c+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p> <p>删除操作同理</p> <h4 id="lr型"><a href="#lr型" class="header-anchor">#</a> LR型</h4> <p>假设插入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>后使得当前子树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span>失衡，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>b</mi></msub><mo>=</mo><msub><mi>h</mi><mi>e</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h_b=h_e+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p> <p>如果直接右旋，会导致<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>h</mi><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>h</mi><mi>e</mi></msub><mo>+</mo><mn>1</mn><mo>&gt;</mo><msub><mi>h</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">h'_r=h_e+1&gt;h_r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> <p>因此要先对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span>进行一次左旋，再对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span>进行右旋</p> <p>删除操作同理</p> <h3 id="java实现及测试代码"><a href="#java实现及测试代码" class="header-anchor">#</a> Java实现及测试代码</h3> <p>实现了<strong>插入</strong>、<strong>删除</strong>操作</p> <p>关键字不可重复</p> <div role="tablist" aria-multiselectable="true" class="el-collapse"><div class="el-collapse-item"><div role="tab" aria-controls="el-collapse-content-55" aria-describedby="el-collapse-content-55"><div role="button" id="el-collapse-head-55" tabindex="0" class="el-collapse-item__header">AVL树代码（展开）<i class="el-collapse-item__arrow el-icon-arrow-right"></i></div></div><div role="tabpanel" aria-hidden="true" aria-labelledby="el-collapse-head-55" id="el-collapse-content-55" class="el-collapse-item__wrap" style="display:none;"><div class="el-collapse-item__content"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token class-name">DataStructure<span class="token punctuation">.</span>Tree</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>istack<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span><span class="token class-name">Nullable</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AVLTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Tree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> root<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> root<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">,</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">,</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> node<span class="token punctuation">;</span>

        <span class="token keyword">int</span> dir <span class="token operator">=</span> node<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">insert</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        node<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">rebalance</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">,</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 没有子节点</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

            <span class="token comment">// 只有一个子节点</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">int</span> notNullIdx <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 子节点方向</span>
                node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>notNullIdx<span class="token punctuation">]</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
                <span class="token keyword">return</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>notNullIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 有两个子节点，先按常规BST的方法删除</span>
            <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> least <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>least<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> least <span class="token operator">=</span> least<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span>value <span class="token operator">=</span> least<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            least<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token function">getDirection</span><span class="token punctuation">(</span>least<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> least<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>least<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> least<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> least<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
            least<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 从least节点开始，一直向上rebalance</span>
            <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> current <span class="token operator">=</span> least<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>current <span class="token operator">!=</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
                current<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                current <span class="token operator">=</span> <span class="token function">rebalance</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">rebalance</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> dir <span class="token operator">=</span> node<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">remove</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">rebalance</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 对节点进行再平衡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">rebalance</span><span class="token punctuation">(</span><span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// dir: 重子树（高度更高的子树）的位置</span>
        <span class="token keyword">int</span> dir <span class="token operator">=</span> <span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> heavy <span class="token operator">=</span> <span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> light <span class="token operator">=</span> <span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>heavy <span class="token operator">-</span> light<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">height</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">rotate</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// LL 或 RR</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// LR 或 RL</span>
                <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> n <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span>dir <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token function">rotate</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 将节点左旋（或右旋）
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> root<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;不能旋转根节点&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> grandParent <span class="token operator">=</span> parent <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token keyword">int</span> direction <span class="token operator">=</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>

        node<span class="token punctuation">.</span>parent <span class="token operator">=</span> grandParent<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>grandParent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> grandParent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token function">getDirection</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span>parent <span class="token operator">=</span> node<span class="token punctuation">;</span>

        parent<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        node<span class="token punctuation">.</span><span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> root <span class="token operator">=</span> node<span class="token punctuation">;</span>
        <span class="token keyword">return</span> node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取当前节点对于父节点的方向
     * @return 如果当前节点为父节点的左子节点，则返回0，否则返回1
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getDirection</span><span class="token punctuation">(</span><span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;不能对根节点调用getDir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 中序遍历二叉树
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result<span class="token punctuation">,</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">height</span><span class="token punctuation">(</span><span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> node <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> node<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> height <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>  parent<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AVLNode</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">T</span> value<span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">AVLNode</span><span class="token punctuation">(</span><span class="token class-name">T</span> v<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> left<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> right<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">AVLNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
            value <span class="token operator">=</span> v<span class="token punctuation">;</span>
            children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> left<span class="token punctuation">;</span>
            children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">updateHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            height <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">height</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br></div></div></div></div></div> <div class="el-collapse-item"><div role="tab" aria-controls="el-collapse-content-912" aria-describedby="el-collapse-content-912"><div role="button" id="el-collapse-head-912" tabindex="0" class="el-collapse-item__header">测试代码（展开）<i class="el-collapse-item__arrow el-icon-arrow-right"></i></div></div><div role="tabpanel" aria-hidden="true" aria-labelledby="el-collapse-head-912" id="el-collapse-content-912" class="el-collapse-item__wrap" style="display:none;"><div class="el-collapse-item__content"><p>测试代码</p> <p>输出：<code>time: 20.106 s</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token class-name">Tree</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token class-name">Tree<span class="token punctuation">.</span>AVLTree<span class="token punctuation">.</span>AVLTree</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TEST_LENGTH <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">judge</span><span class="token punctuation">(</span><span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">generateRandomNumber</span><span class="token punctuation">(</span>TEST_LENGTH<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;err on &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">long</span> begin <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">speedTest</span><span class="token punctuation">(</span><span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">generateSortedNumber</span><span class="token punctuation">(</span>TEST_LENGTH<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">speedTest</span><span class="token punctuation">(</span><span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">generateRandomNumber</span><span class="token punctuation">(</span>TEST_LENGTH<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;time : &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> begin<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000.</span> <span class="token operator">+</span> <span class="token string">&quot; s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">speedTest</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AVLTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> tree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AVLTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token operator">:</span> data<span class="token punctuation">)</span> tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Random</span> ran <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>TEST_LENGTH <span class="token operator">*</span> <span class="token number">0.3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> v <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tree<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">judge</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">AVLTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> tree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AVLTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> groundTrue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token operator">:</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
            tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            groundTrue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Random</span> ran <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>TEST_LENGTH <span class="token operator">*</span> <span class="token number">0.3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> v <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            groundTrue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tree<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> resultOfTree <span class="token operator">=</span> tree<span class="token punctuation">.</span><span class="token function">travel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> groundTrue<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token operator">:</span> resultOfTree<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> v<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div></div></div></div></div> <h3 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h3> <ul><li><p>插入优化：</p> <p>在插入单个<strong>一个</strong>新节点时，从被插入的节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>到树的根节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">root</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span></span>这一路径上所有节点的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>(<code>平衡因子</code>)都可能会被改变，因此需要回溯更新。</p> <p>但如果某一节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>更新后为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，则说明以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>为根的这一子树高度没有发生变化，因此<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">root</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span></span>这些节点不需要再更新。</p></li> <li><p>删除优化：</p> <p>再删除<strong>一个</strong>节点以后，从被删除的节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>到根节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">root</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span></span>路径上的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>都可能改变，因此要回溯更新。</p> <p>由于删除单个节点，子树的高度最多减1；如果某一节点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>变为了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1/-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，那么说明<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的高度没有变化，因此后续节点不需要再回溯更新。</p></li></ul> <h3 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h3> <ul><li>https://en.wikipedia.org/wiki/AVL_tree</li></ul> <h2 id="b树-b-树"><a href="#b树-b-树" class="header-anchor">#</a> B树（B-树）</h2> <p>B树是一种自平衡多叉树。</p> <p>性质：对于一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>阶B树：</p> <ul><li>所有叶子节点在同一层</li> <li>每个节点至多有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>个子树</li> <li>除根/叶子节点外，每个节点至少有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span>个子树，所有节点的子树个数（即<code>出度数</code>）= 关键码个数 + 1</li> <li>根节点至少有两个子树</li></ul> <p>也就是说，根节点的关键字数量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1\le k \le m-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，非根节点关键字数量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">k'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn><mo>≤</mo><msup><mi>k</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil - 1 \le k' \le m-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>阶B树也被称为 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>)树。如<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">M=3</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>，则称为<code>2-3树</code></p> <h3 id="插入与删除"><a href="#插入与删除" class="header-anchor">#</a> 插入与删除</h3> <h4 id="插入"><a href="#插入" class="header-anchor">#</a> 插入</h4> <p>插入时总是插入到叶子节点中。当节点的关键字个数超过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时，需要进行调整。</p> <p>下图是一个<code>3-5</code>树，此时坐下的节点不符合B树性质，需要进行分裂</p> <p><img src="data:image/jpeg;base64,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" alt=""></p> <p>取<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>18</mn><mo separator="true">,</mo><mn>22</mn><mo separator="true">,</mo><mn>23</mn><mo separator="true">,</mo><mn>25</mn><mo separator="true">,</mo><mn>39</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(18,22,23,25,39)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">9</span><span class="mclose">)</span></span></span></span>中间的值（即23），将其放入父节点中，并将原节点分裂成两部分</p> <p><img src="/assets/img/B树_2.65a3addb.jpg" alt=""></p> <p>若分裂后父节点的关键字个数大于4，则需要进一步分裂父节点。</p> <h4 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h4> <p>删除时需要考虑的情况较多，记<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">mn</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span></span></span></span>为非根节点关键字个数下限，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi><mo>=</mo><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mn=\lceil \frac{m}{2}\rceil - 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p> <ul><li><p>删除的是叶子节点中的关键字</p> <ul><li><p>删除后未破坏B树性质：无需处理</p></li> <li><p>删除后破坏B树性质（关键字个数小于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">mn</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span></span></span></span>）：</p> <ul><li><p>如果兄弟节点（左侧或右侧的任意一个）的关键字个数<strong>大于</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">mn</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span></span></span></span>：</p> <p>先将父节点的一个关键字<strong>移动</strong>到当前节点（前驱或后继）</p> <p>然后，从兄弟节点中取一个关键字<strong>移动</strong>到父节点中，删除操作完成</p></li> <li><p>如果兄弟节点的关键字个数<strong>等于</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">mn</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span></span></span></span>：</p> <p>先将父节点的一个关键字<strong>移动</strong>到当前节点</p> <p>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2\times(\lceil \frac{m}{2}\rceil - 1)\le m-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，因此可以将当前节点与兄弟节点<strong>合并</strong></p> <p>若此时父节点关键字个数不满足B树性质，则需要继续向上修正</p></li></ul></li></ul> <p>需要特别说明的是：</p> <ol><li>如果能够从兄弟节点借，此后父节点必定满足B树性质，无需继续向上修正</li> <li>因此，若对非叶子节点进行修正，则之前执行的必定是<strong>合并</strong>操作</li></ol></li> <li><p>删除的是非叶子结点中的关键字<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></p> <p>此时需要将关键字<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span><strong>替换</strong>为后继<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>（或前驱），并在子节点中<strong>删除</strong>该关键字<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>。这个过程有点类似<code>BST</code>的删除操作。</p></li></ul> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <p>在磁盘等介质上进行读写时，如果树的深度过大则会产生大量的IO操作，因此需要减少树的高度。</p> <p>同时，B树能够更的利用磁盘成块（扇区）读写的性质</p> <h3 id="java实现"><a href="#java实现" class="header-anchor">#</a> Java实现</h3> <p>实现了<strong>插入</strong>与<strong>删除</strong>功能</p> <p>默认实现<code>2-3</code>树</p> <p>关键字不可重复，代码内有注释以及<code>assert</code>作为提示。</p> <div role="tablist" aria-multiselectable="true" class="el-collapse"><div class="el-collapse-item"><div role="tab" aria-controls="el-collapse-content-4558" aria-describedby="el-collapse-content-4558"><div role="button" id="el-collapse-head-4558" tabindex="0" class="el-collapse-item__header">B树代码（展开）<i class="el-collapse-item__arrow el-icon-arrow-right"></i></div></div><div role="tabpanel" aria-hidden="true" aria-labelledby="el-collapse-head-4558" id="el-collapse-content-4558" class="el-collapse-item__wrap" style="display:none;"><div class="el-collapse-item__content"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token class-name">DataStructure<span class="token punctuation">.</span>Tree</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Comparator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Tree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> maxChildSize<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> minChildSize<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> maxKeySize<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> minKeySize<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> root<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">BTree</span><span class="token punctuation">(</span><span class="token keyword">int</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        maxChildSize <span class="token operator">=</span> order<span class="token punctuation">;</span>
        minChildSize <span class="token operator">=</span> <span class="token punctuation">(</span>order <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        maxKeySize <span class="token operator">=</span> maxChildSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        minKeySize <span class="token operator">=</span> minChildSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 找到第一个可以插入的叶子节点</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> current <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span><span class="token function">isLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                current<span class="token punctuation">.</span><span class="token function">addKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>keySize <span class="token operator">&gt;</span> maxKeySize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">splitNode</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 非叶子节点，找到第一个大于 key 的内部节点</span>
            <span class="token keyword">assert</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>keySize <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> current<span class="token punctuation">.</span>childSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> iter<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>iter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> iter <span class="token operator">&lt;</span> current<span class="token punctuation">.</span>keySize<span class="token punctuation">;</span> iter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>iter<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            current <span class="token operator">=</span> current<span class="token punctuation">.</span>children<span class="token punctuation">[</span>iter<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> node <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">isLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                node<span class="token punctuation">.</span><span class="token function">removeKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">combine</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// 找到它的前驱</span>
                <span class="token keyword">int</span> idxOfKey <span class="token operator">=</span> node<span class="token punctuation">.</span><span class="token function">indexOfKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> greatestNode <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>idxOfKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>greatestNode<span class="token punctuation">.</span><span class="token function">isLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    greatestNode <span class="token operator">=</span> greatestNode<span class="token punctuation">.</span>children<span class="token punctuation">[</span>greatestNode<span class="token punctuation">.</span>childSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">K</span> greatestKey <span class="token operator">=</span> greatestNode<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>greatestNode<span class="token punctuation">.</span>keySize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                node<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>idxOfKey<span class="token punctuation">]</span> <span class="token operator">=</span> greatestKey<span class="token punctuation">;</span>
                greatestNode<span class="token punctuation">.</span><span class="token function">removeKey</span><span class="token punctuation">(</span>greatestKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">combine</span><span class="token punctuation">(</span>greatestNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 修复删除关键字导致的节点关键字过少
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>keySize <span class="token operator">&gt;=</span> minKeySize<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> root<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> parent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token keyword">int</span> nodeIdx <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">indexOfChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> usingPrecursor <span class="token operator">=</span> nodeIdx <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 兄弟节点是否是前驱（小于当前节点）</span>
        <span class="token keyword">int</span> neighborIdx <span class="token operator">=</span> nodeIdx <span class="token operator">+</span> <span class="token punctuation">(</span>usingPrecursor <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 在node与neighbor之间的key</span>
        <span class="token class-name">K</span> parentKey <span class="token operator">=</span> usingPrecursor <span class="token operator">?</span> parent<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>nodeIdx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> parent<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>nodeIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> neighbor <span class="token operator">=</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span>neighborIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span><span class="token function">removeKey</span><span class="token punctuation">(</span>parentKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        node<span class="token punctuation">.</span><span class="token function">addKey</span><span class="token punctuation">(</span>parentKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>neighbor<span class="token punctuation">.</span>keySize <span class="token operator">&gt;</span> minKeySize<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 从兄弟节点借</span>
            <span class="token class-name">K</span> neighborKey <span class="token operator">=</span> neighbor<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>usingPrecursor <span class="token operator">?</span> neighbor<span class="token punctuation">.</span>keySize <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            neighbor<span class="token punctuation">.</span><span class="token function">removeKey</span><span class="token punctuation">(</span>neighborKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            parent<span class="token punctuation">.</span><span class="token function">addKey</span><span class="token punctuation">(</span>neighborKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>neighbor<span class="token punctuation">.</span>childSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> neighborChild <span class="token operator">=</span> neighbor<span class="token punctuation">.</span>children<span class="token punctuation">[</span>usingPrecursor <span class="token operator">?</span> neighbor<span class="token punctuation">.</span>childSize <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                neighbor<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>neighborChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
                node<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>neighborChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 无法从兄弟节点借，合并</span>
            parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>neighbor<span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span><span class="token function">addKeys</span><span class="token punctuation">(</span>neighbor<span class="token punctuation">.</span>keys<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> neighbor<span class="token punctuation">.</span>keySize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token punctuation">.</span><span class="token function">addChildren</span><span class="token punctuation">(</span>neighbor<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> neighbor<span class="token punctuation">.</span>childSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 除根节点外，每个节点至少有minKeySize个key</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>keySize <span class="token operator">&lt;</span> minKeySize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">combine</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>keySize <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                node<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                root <span class="token operator">=</span> node<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">splitNode</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>keySize <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> parent <span class="token operator">=</span> node <span class="token operator">==</span> root <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">:</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            root <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>keySize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span><span class="token function">addKey</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        left<span class="token punctuation">.</span><span class="token function">addKeys</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>keys<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        right<span class="token punctuation">.</span><span class="token function">addKeys</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>keys<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> node<span class="token punctuation">.</span>keySize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>childSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            left<span class="token punctuation">.</span><span class="token function">addChildren</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            right<span class="token punctuation">.</span><span class="token function">addChildren</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> node<span class="token punctuation">.</span>childSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        parent<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>keySize <span class="token operator">&gt;</span> maxKeySize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">splitNode</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> current <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>current <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> iter<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>iter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> iter <span class="token operator">&lt;</span> current<span class="token punctuation">.</span>keySize<span class="token punctuation">;</span> iter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> diff <span class="token operator">=</span> current<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>iter<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>diff <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> current<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>diff <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            current <span class="token operator">=</span> current<span class="token punctuation">.</span>children<span class="token punctuation">[</span>iter<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> result<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> node<span class="token punctuation">.</span>keySize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>childSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>node<span class="token punctuation">.</span>childSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keys <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">Comparable</span><span class="token punctuation">[</span>maxKeySize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>maxChildSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> keySize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> childSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> comparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> o1<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> o2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> o1<span class="token punctuation">.</span>keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>o2<span class="token punctuation">.</span>keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addKey</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            keys<span class="token punctuation">[</span>keySize<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">;</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> keySize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addKeys</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token keyword">to</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> from<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">to</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                keys<span class="token punctuation">[</span>keySize<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> keySize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">removeKey</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">boolean</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keySize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    keys<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    found <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            keySize<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addChild</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            children<span class="token punctuation">[</span>childSize<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> child<span class="token punctuation">;</span>
            child<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> childSize<span class="token punctuation">,</span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addChildren</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token keyword">to</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> from<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">to</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                children<span class="token punctuation">[</span>childSize<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> childSize<span class="token punctuation">,</span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">boolean</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> childSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    children<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">==</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    found <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            childSize<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">indexOfChild</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">&gt;</span></span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> childSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> child<span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;未找到该子节点&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">indexOfKey</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keySize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;未找到该关键字&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> childSize <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;keys: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keySize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br></div></div></div></div></div></div> <p>测试代码与AVL树的类似，略</p> <h3 id="参考资料-2"><a href="#参考资料-2" class="header-anchor">#</a> 参考资料</h3> <ul><li>https://my.oschina.net/u/4116286/blog/3107389 （删除部分有误）</li> <li>https://blog.csdn.net/qq_41078889/article/details/108756708</li> <li>https://github.com/phishman3579/java-algorithms-implementation</li> <li>https://en.wikipedia.org/wiki/B-tree</li></ul> <h2 id="b-树"><a href="#b-树" class="header-anchor">#</a> B+树</h2> <p>B+树与B树类似，其不同点如下：</p> <ul><li>叶子节点保存关键字的全部信息，且叶子节点之间依据关键字大小相互链接（链表）</li> <li>非叶子结点可以看做索引，存放的是对应子树中最小/最大关键字（一说是直接子节点的最小/最大关键字）</li></ul> <p>关于关键字个数的限制，在查阅资料后，发现有两种说法：</p> <ul><li>说法一：
<ul><li>内部节点的关键字个数等于子节点个数</li></ul></li> <li>说法二：
<ul><li>内部节点的关键字个数等于子节点个数-1（同B树）</li></ul></li></ul> <p>另外，中文Wiki与英文Wiki中关于每个节点中关键字的最低数量有冲突，而英文wiki的参考资料又与wiki冲突，建议自行取舍。</p> <h3 id="优点-2"><a href="#优点-2" class="header-anchor">#</a> 优点</h3> <ul><li><p>由于内部节点不需要保存完整信息，因此单一节点可以保存更多信息，IO次数更少。</p></li> <li><p>叶节点形成链表，在范围查询时不需要进行中序遍历</p></li> <li><p>查询数据必定要查找到叶子节点，性能稳定（这算优点？？？）</p></li></ul> <h3 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h3> <p>与B树唯一的差别在于：</p> <ol><li>添加关键字时，若关键字个数过多需要分裂，要注意仅叶子节点需要保存值</li> <li>删除关键字时，对于叶子节点，由于有兄弟节点的&quot;指针&quot;，因此可以不经父节点获取到兄弟节点</li> <li>添加关键字时要沿途更新索引，删除关键字后要向根节点方向更新索引</li></ol> <h3 id="参考资料-3"><a href="#参考资料-3" class="header-anchor">#</a> 参考资料</h3> <ul><li>https://www.geeksforgeeks.org/introduction-of-b-tree/</li> <li>https://en.wikipedia.org/wiki/B%2B_tree</li> <li>https://zh.wikipedia.org/wiki/B%2B%E6%A0%91</li> <li>https://segmentfault.com/a/1190000020416577</li></ul> <h2 id="红黑树"><a href="#红黑树" class="header-anchor">#</a> 红黑树</h2> <p>红黑树是一棵自平衡二叉树，满足以下性质</p> <ol><li><p>任何节点要么是红色，要么是黑色</p></li> <li><p>根节点是黑色（不重要）</p></li> <li><p>所有叶子节点（NIL，不含任何数据）是黑色的</p></li> <li><p>如果一个节点是红色的，则其子节点是黑色的</p></li> <li><p>任意一个点到其子孙叶子节点的所有路径中，黑节点个数相同</p></li></ol> <p>由性质4/5可以看出：从根节点到所有叶子节点的路径中，最长的长度<strong>小于等于</strong>最短的两倍</p> <p>一颗含有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>个节点的红黑树高度至多为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2log(n+1)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p> <h3 id="插入操作"><a href="#插入操作" class="header-anchor">#</a> 插入操作</h3> <p>插入时，先按普通二叉树的方式插入，并把插入的节点染成红色，此时显然不会违背性质1/2/3/5，因此只需检查性质4</p> <ul><li><p>当父节点是黑色节点</p> <p>满足性质4，插入完成</p></li> <li><p>当父节点是红色节点</p> <p>由于根节点必定是黑色节点（性质二），而父节点是红色节点，因此必定有祖父节点（黑色），进而必定有叔叔节点（内部节点或NIL节点）</p> <ul><li><p>叔叔节点是红色</p> <p>将父节点、叔叔节点染为黑色，将祖父节点染为红色，并继续检查祖父节点是否满足性质4</p></li> <li><p>叔叔节点是黑色</p> <ul><li><p>LR/RL型：在当前节点上进行一次旋转，使之变成LL/RR型</p></li> <li><p>LL/RR型：</p> <p>对父节点进行一次旋转，并把父节点染成黑色，同时为了避免性质5被破坏，将<strong>原祖父节点</strong>染为红色（由于<strong>原叔叔节点</strong>是黑色，<strong>原兄弟节点</strong>是黑色，因而不会破坏性质4）</p></li></ul></li></ul></li></ul> <p>解决问题的关键在于<strong>不断将多余的红色节点向根节点方向移动</strong></p> <h3 id="删除操作-较难理解-附图"><a href="#删除操作-较难理解-附图" class="header-anchor">#</a> 删除操作（较难理解，附图）</h3> <p>（删除总比插入难）</p> <p>二叉树删除节点时，若被删除节点有2个非空子节点，总可以通过与前驱/后继交换值的方法，转换为删除至多只有一个非空孩子的节点，因此接下来只讨论删除至多只有一个非空孩子的节点</p> <ul><li><p>若该节点是<strong>红色</strong>的，删除它并不会破坏红黑树的性质，因而无需额外操作</p></li> <li><p>若该节点是<strong>黑色</strong>的，且它的子节点是<strong>红色</strong>的，此时只需将子节点染为<strong>黑色</strong>即可保持性质5</p></li> <li><p>若该节点是<strong>黑色</strong>的，且他的子节点是<strong>黑色</strong>时的情况：</p> <p>此时该节点的子节点必定都是NIL（否则，一子节点为非叶子结点，此时违反性质5）</p> <p>将该节点删去（用NIL代替），为了维持性质5，我们暂且认为新的NIL等价于2个黑色节点（图中用正方形表示）</p> <img src="/assets/img/红黑树_1.9d5bc7d8.png" style="zoom:60%;"> <p>如上图所示，图中使用蓝色代表黑色节点，白色代表黑色或红色节点（不得不吐槽一句，Visio真的不好用）</p> <p>下面开始分类讨论</p> <ol><li><p><code>brother</code>为<strong>黑色</strong>，且<code>brother</code>有一个<strong>红色</strong>子节点，如下图所示</p> <img src="/assets/img/红黑树_2.1aebc926.png" style="zoom:66%;"> <p>如果红色节点与其父节点、祖父节点形成LR/RL型结构，则需要进行一次旋转（并重新染色）转化为LL/RR型，如上图(1)所示</p> <p>对于LL/RR型，则旋转兄弟节点，原父节点与兄弟节点交换颜色，并将子节点染为黑色（如上图(2)所示），相当于从兄弟节点借了一个黑色节点</p></li> <li><p><code>brother</code>为<strong>黑色</strong>，且无<strong>红色</strong>子节点</p> <img src="/assets/img/红黑树_3.170cf92d.png" style="zoom:60%;"> <p>如图所示，若<code>parent</code>为<strong>红色</strong>，则重新染色即可</p> <p>否则，将特殊节点上移并重新染色，若<code>parent</code>不为根节点，则需要继续对<code>parent</code>进行修复</p></li> <li><p>若<code>brother</code>为<strong>红色</strong></p> <img src="/assets/img/红黑树_4.d42e9bce.png" style="zoom:60%;"> <p>如图所示，旋转<code>brother</code>并重新染色，此时<code>node</code>的兄弟节点必定是黑色，转化为情况1/2</p></li></ol></li></ul> <h3 id="java实现-2"><a href="#java实现-2" class="header-anchor">#</a> Java实现</h3> <p>测试未通过</p> <div role="tablist" aria-multiselectable="true" class="el-collapse"><div class="el-collapse-item"><div role="tab" aria-controls="el-collapse-content-9871" aria-describedby="el-collapse-content-9871"><div role="button" id="el-collapse-head-9871" tabindex="0" class="el-collapse-item__header">红黑树代码（展开）<i class="el-collapse-item__arrow el-icon-arrow-right"></i></div></div><div role="tabpanel" aria-hidden="true" aria-labelledby="el-collapse-head-9871" id="el-collapse-content-9871" class="el-collapse-item__wrap" style="display:none;"><div class="el-collapse-item__content"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token class-name">DataStructure<span class="token punctuation">.</span>Tree</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>istack<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span><span class="token class-name">Nullable</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedBlackTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Tree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> root<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">T</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 按照普通二叉树的方法插入</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> direction <span class="token operator">=</span> cur<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
                direction <span class="token operator">=</span> direction <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cur<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span> <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
                    <span class="token function">balanceAfterInsertion</span><span class="token punctuation">(</span>newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">T</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> toRemoved <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>toRemoved <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token comment">// 当需要删除根节点，且根节点只有一个非空子节点</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>toRemoved <span class="token operator">==</span> root <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            root <span class="token operator">=</span> root<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> root<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> root<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>root <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> successor <span class="token operator">=</span> <span class="token function">getSuccessor</span><span class="token punctuation">(</span>toRemoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
            toRemoved<span class="token punctuation">.</span>key <span class="token operator">=</span> successor<span class="token punctuation">.</span>key<span class="token punctuation">;</span><span class="token punctuation">;</span>
            toRemoved <span class="token operator">=</span> successor<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;impossible&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> childOfRemoved <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            childOfRemoved <span class="token operator">=</span> toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            childOfRemoved <span class="token operator">=</span> toRemoved<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">setChild</span><span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>parent<span class="token punctuation">,</span> childOfRemoved<span class="token punctuation">,</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>toRemoved<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>toRemoved<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>childOfRemoved <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> childOfRemoved<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                childOfRemoved<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>childOfRemoved <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;childOfRemoved应当是null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">balanceAfterDeletion</span><span class="token punctuation">(</span>childOfRemoved<span class="token punctuation">,</span> toRemoved<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">balanceAfterInsertion</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            node<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;应当存在祖父节点&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> uncle <span class="token operator">=</span> <span class="token function">getUncle</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
            <span class="token keyword">char</span> uncleColor <span class="token operator">=</span> uncle <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK <span class="token operator">:</span> uncle<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>uncleColor <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
                <span class="token function">balanceAfterInsertion</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> parentDirection <span class="token operator">=</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> selfDirection <span class="token operator">=</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>selfDirection <span class="token operator">!=</span> parentDirection<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// LR型或RL型</span>
                    <span class="token function">rotate</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 旋转后，parent已经变成了node的子节点</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> tmp <span class="token operator">=</span> parent<span class="token punctuation">;</span>
                    parent <span class="token operator">=</span> node<span class="token punctuation">;</span>
                    node <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// LL/RR</span>
                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> grandParent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
                <span class="token function">rotate</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 旋转后，grandParent变为parent的子节点</span>
                parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                grandParent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 删除节点后重新平衡子树
     * @param node 当前节点
     * @param parent 由于当前节点可能为null，因此需要提供父节点
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">balanceAfterDeletion</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> root<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> selfDirection <span class="token operator">=</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> brotherDirection <span class="token operator">=</span> selfDirection <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> brother <span class="token operator">=</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span>brotherDirection<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>brother <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;兄弟节点不可能为空&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>brother<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> redChildOfBrother <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>selfDirection<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
                    brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>selfDirection<span class="token punctuation">]</span><span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                redChildOfBrother <span class="token operator">=</span> selfDirection<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>brotherDirection<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
                    brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>brotherDirection<span class="token punctuation">]</span><span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                redChildOfBrother <span class="token operator">=</span> brotherDirection<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>redChildOfBrother <span class="token operator">==</span> selfDirection<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// LR/RL, 转为LL/RR型</span>
                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> redChild <span class="token operator">=</span> brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>redChildOfBrother<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token function">rotate</span><span class="token punctuation">(</span>redChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
                redChild<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                brother <span class="token operator">=</span> redChild<span class="token punctuation">;</span>
                redChildOfBrother <span class="token operator">=</span> brotherDirection<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>redChildOfBrother <span class="token operator">==</span> brotherDirection<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// LL/RR</span>
                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> redChild <span class="token operator">=</span> brother<span class="token punctuation">.</span>children<span class="token punctuation">[</span>redChildOfBrother<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token function">rotate</span><span class="token punctuation">(</span>brother<span class="token punctuation">)</span><span class="token punctuation">;</span>
                redChild<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> parent<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 兄弟节点无红色子节点</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
                    brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
                    <span class="token function">balanceAfterDeletion</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 兄弟节点为红色</span>
            <span class="token function">rotate</span><span class="token punctuation">(</span>brother<span class="token punctuation">)</span><span class="token punctuation">;</span>
            brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>BLACK<span class="token punctuation">;</span>
            parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token class-name">Node</span><span class="token punctuation">.</span>RED<span class="token punctuation">;</span>
            <span class="token function">balanceAfterDeletion</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 对当前节点进行旋转（左旋或右旋），使其与父节点交换位置
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;不能旋转根节点&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> grandParent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token keyword">int</span> selfDirection <span class="token operator">=</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">setChild</span><span class="token punctuation">(</span>grandParent<span class="token punctuation">,</span> node<span class="token punctuation">,</span> grandParent <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token function">getDirection</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setChild</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>selfDirection <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> selfDirection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setChild</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> selfDirection <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>grandParent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            root <span class="token operator">=</span> node<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setChild</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> child<span class="token punctuation">,</span> <span class="token keyword">int</span> direction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span>direction<span class="token punctuation">]</span> <span class="token operator">=</span> child<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>child <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> child<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取当前节点的叔叔节点
     *
     * @return 如果叔叔节点不存在，则返回null
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUncle</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> grandParent <span class="token operator">=</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
        <span class="token keyword">return</span> grandParent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token function">getDirection</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取当前节点对于父节点的方向
     *
     * @return 如果当前节点为父节点的左子节点，则返回0，否则返回1
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getDirection</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> node<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> node <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token class-name">T</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> diff <span class="token operator">=</span> node<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>diff <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> node<span class="token punctuation">;</span>
            node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>diff <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 寻找当前子树下的后继，若不存在则返回null
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSuccessor</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 中序遍历
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">travel</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> result<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">travel</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">char</span> BLACK <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">char</span> RED <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">;</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> children<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">T</span> key<span class="token punctuation">;</span>
        <span class="token keyword">char</span> color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>

        <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">,</span> <span class="token class-name">T</span> key<span class="token punctuation">,</span> <span class="token keyword">char</span> color<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br></div></div></div></div></div></div> <h3 id="参考资料-4"><a href="#参考资料-4" class="header-anchor">#</a> 参考资料</h3> <ul><li><p>https://en.wikipedia.org/wiki/Red%E2%80%93black_tree</p></li> <li><p>https://zh.wikipedia.org/wiki/%E7%BA%A2%E9%BB%91%E6%A0%91</p></li> <li><p>https://www.cnblogs.com/skywang12345/p/3245399.html</p></li> <li><p>https://www.tianxiaobo.com/2018/01/11/%E7%BA%A2%E9%BB%91%E6%A0%91%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/</p></li> <li><p>https://segmentfault.com/a/1190000012115424（推荐阅读）</p></li></ul> <h2 id="其他树-线段树-linkcuttree-splay等"><a href="#其他树-线段树-linkcuttree-splay等" class="header-anchor">#</a> 其他树（线段树/LinkCutTree/Splay等）</h2> <p>见 算法学习-数据结构 一栏</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/03/27, 23:40:59</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e5000b/"><div>深入理解Java虚拟机</div></a> <span>03-04</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/0438b8/"><div>DNS工作原理</div></a> <span>02-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/4f9f4f/"><div>改用VuePress啦</div></a> <span>02-23</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/chgtaxihe" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2021
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.decb9dad.js" defer></script><script src="/assets/js/2.04fd8913.js" defer></script><script src="/assets/js/3.4c5a2de2.js" defer></script>
  </body>
</html>